(function(a){"use strict";a(".tpgb-search-bar").each(function(){var b=a(this),c=b.data("id"),d=b.find(".tpgb-search-form"),e=b.data("ajax_search"),f=b.data("acfdata"),g=b.data("genericfilter"),h=b.find(".tpgb-search-list-inner"),i=b.find(".tpgb-search-btn"),j=b.find(".tpgb-search-area"),k=b.find(".tpgb-search-header"),l=b[0].dataset?JSON.parse(b[0].dataset.resultSetting):[],m=b[0].dataset?JSON.parse(b[0].dataset.paginationData):[],n=b[0].dataset?JSON.parse(b[0].dataset.defaultData):[];h.css("transform","translateX(0)");let o=b[0].querySelectorAll(".tpgb-rental-overlay");0<o.length&&function(b){let c=b[0].querySelector(".tpgb-rental-overlay"),d=b[0].querySelector(".tpgb-input-field");a(".tpgb-search-input",b).on({focus:function(){c.style.cssText="visibility:visible;opacity:1;",d.style.cssText="z-index:1000;"},focusout:function(){c.style.cssText="visibility:hidden;opacity:0;",d.style.cssText=""}}),a(".tpgb-select",b).on("click",function(){c.style.cssText="visibility:visible;opacity:1;"}),a(".tpgb-rental-overlay",b).on("click",function(){c.style.cssText="visibility:hidden;opacity:0;"}),b.keyup(function(a){"Escape"===a.key&&(c.style.cssText="visibility:hidden;opacity:0;")})}(b);let p=b[0].querySelectorAll(".tpgb-sbar-dropdown");if(0<p.length&&(a(".tpgb-sbar-dropdown",a(this)).on("click",function(){a(this).attr("tabindex",1).focus(),a(this).toggleClass("active"),a(this).find(".tpgb-sbar-dropdown-menu").slideToggle(300)}),a(".tpgb-sbar-dropdown",a(this)).focusout(function(){a(this).removeClass("active"),a(this).find(".tpgb-sbar-dropdown-menu").slideUp(300)}),a(".tpgb-sbar-dropdown .tpgb-sbar-dropdown-menu .tpgb-searchbar-li",a(this)).on("click",function(){a(this).parents(".tpgb-sbar-dropdown").find("span.search-selected-text").text(a(this).text()),a(this).parents(".tpgb-sbar-dropdown").find("input").attr("value",a(this).attr("id")).change()})),"yes"==e.ajax){function c(){let c=a("input[name=s]",b).val(),d=a("input[name=taxonomy]",b).val(),i=a("input[name=post_type]",b).val();h.html(""),k.find(".tpgb-search-pagina",b).html("");let o={action:"tpgb_search",searchData:a(".tpgb-search-form",b).serialize(),text:c,postper:e.post_page,GFilter:g,ACFilter:f,ResultData:m,DefaultData:n,nonce:e.nonce};a.ajax({url:tpgb_load.ajaxUrl,method:"post",async:!0,data:o,beforeSend:function(){"pagination"==m.Pagestyle&&(b[0].querySelector(".tpgb-search-list-inner").style.cssText="transform: translateX(0px)")},success:function(a){let c=b[0].querySelectorAll(".tpgb-search-error"),d=b[0].querySelector(".tpgb-search-header");if(a.data.error&&0<c.length)return c[0].style.cssText="display:block",c[0].innerHTML=a.data.message,d.style.cssText="display:none",void j.slideDown(100);c[0].style.cssText="display:none",d.style.cssText="display:flex",c[0].innerHTML="";var e=a.data?a.data:"";if(e&&0!==e.post_count){let a=e.posts,c=null,d="",f="<div class=\""+".tpgb-search-slider tpgb-row".replace(".","")+"\">%s</div>",g="";for(c in j.slideDown(100),a)g+=v(a[c]),(0==(parseInt(c)+1)%e.limit_query||parseInt(c)===a.length-1)&&(d+=f.replace("%s",g),g="");if(h.html(d),l.TotalResult){let a=l.TotalResultTxt?l.TotalResultTxt:"";k.find(".tpgb-search-resultcount").html(e.post_count+" "+a)}if(e.pagination)b[0].querySelector(".tpgb-search-pagina").innerHTML=e.pagination,y(".tpgb-search-slider tpgb-row",h,e,o);else if(!e.loadmore)e.lazymore&&e.total_count>e.limit_query&&(b[0].querySelector(".tpgb-lazy-load").innerHTML=e.lazymore,x(".tpgb-search-slider tpgb-row",h,e,o));else if(e.total_count>e.limit_query)b[0].querySelector(".tpgb-load-more").innerHTML=e.loadmore,w(".tpgb-search-slider tpgb-row",h,e,o);else{let a=b[0].querySelectorAll(".tpgb-search-pagina");0<a.length&&(a[0].innerHTML=e.loadmore_page)}}else return c[0].style.cssText="display:block",c[0].innerHTML=l.errormsg,d.style.cssText="display:none",void j.slideDown(400)},complete:function(){let a=document.querySelectorAll(".tpgb-search-input");0<a.length&&a.forEach(a=>{setTimeout(function(){a.blur()},500)})}}).then(function(){setTimeout(function(){b[0].querySelector(".tpgb-ajx-loading").style.cssText="display:none",b[0].querySelector(".tpgb-close-btn").style.cssText="display:flex"},500),B()})}var q=m.PNavigation?m.PNavigation:0,r=e&&e.post_page?e.post_page:3,s=n&&n.SpecialCTP?n.SpecialCTP:0,t=e&&e.ajaxsearchCharLimit?e.ajaxsearchCharLimit:0,u=null;a(b[0]).on("change keyup",function(d){let e=d.type,f=a("input[name=s]",a(this)).val(),g=a("input[name=post_type]",a(this)).val(),h=a("input[name=taxonomy]",a(this)).val(),i=a("input[name=cat]",a(this)).val();if("keyup"==e&&f.length>=t||"change"==e&&g&&0==s||g&&f.length>=t||""==g&&f.length>=t||i&&0==s||i&&f.length>=t||""==i&&f.length>=t)b[0].querySelector(".tpgb-close-btn").style.cssText="display:none",b[0].querySelector(".tpgb-ajx-loading").style.cssText="display:flex",clearTimeout(u),u=setTimeout(c.bind(void 0,d.target.value),400);else{b[0].querySelectorAll(".tpgb-close-btn")}})}var v=function(a){let b="",c=a.title?a.title:"",d=a.content?a.content:"",f=l&&l.ResultlinkOn?l.ResultlinkOn:"",g=f&&l&&l.Resultlinktarget?"target=\""+l.Resultlinktarget+"\"":"",h=f&&a&&a.link?"href=\""+a.link+"\"":"";if(l.textlimit){if(l.TxtTitle){let a=l.textcount?l.textcount:100,b=l.textdots?l.textdots:"";"char"==l.texttype?c=c.substring(0,a)+b:"word"==l.texttype&&(c=c.split(" ",a).toString().replace(/,/g," ")+b)}if(l.Txtcont){let a=l.ContCount?l.ContCount:100,b=l.ContDots?l.ContDots:"";"char"==l.ContType?d=d.substring(0,a)+b:"word"==l.ContType&&(d=d.split(" ",a).toString().replace(/,/g," ")+b)}}return b+="<div class=\"tpgb-ser-item tpgb-trans-linear "+e.styleColumn+"\">",b+="<a class=\"tpgb-serpost-link tpgb-trans-easeinout\" "+h+" "+g+" >",l.ONThumb&&a.thumb&&(b+="<div class=\"tpgb-serpost-thumb\">",b+="<img class=\"tpgb-item-image\" src="+a.thumb+">",b+="</div>"),b+="<div class=\"tpgb-serpost-wrap\">",(l.ONTitle&&c||l.ONPrice&&a.Wo_Price)&&(b+="<div class=\"tpgb-serpost-inner-wrap\">",l.ONTitle&&c&&(b+="<div class=\"tpgb-serpost-title\">"+c+"</div>"),l.ONPrice&&a.Wo_Price&&(b+="<div class=\"tpgb-serpost-price\">"+a.Wo_Price+"</div>"),b+="</div>"),l.ONContent&&d&&(b+="<div class=\"tpgb-serpost-excerpt\">"+d+"</div>"),l.ONShortDesc&&a.Wo_shortDesc&&(b+="<div class=\"tpgb-serpost-shortDesc\">"+a.Wo_shortDesc+"</div>"),b+="</div>",b+="</a>",b+="</div>",b},w=function(c,d,e,f){let g=b[0].querySelectorAll(".post-load-more"),h=b[0].querySelector(".tpgb-search-slider"),i=b[0].querySelectorAll(".tpgb-search-pagina");0<i.length&&(i[0].innerHTML=e.loadmore_page),0<g.length&&g[0].addEventListener("click",function(){let c=+this.dataset.page,d=+(c+1),e=b[0].querySelectorAll(".tpgb-ser-item");f.offset=e.length,f.loadNumpost=m.loadnumber,jQuery.ajax({url:tpgb_load.ajaxUrl,method:"post",async:!0,data:f,beforeSend:function(){g[0].textContent=m.loadingtxt},success:function(c){g[0].textContent=m.loadbtntxt;let e=c.data.posts,f=c.data.total_count,j=null,k="";for(j in e)k+=v(e[j]);if(a(h).append(k),g[0].setAttribute("data-page",d),0<i.length){let a=i[0].querySelectorAll(".tpgb-load-number");a[0].textContent=d}let l=b[0].querySelectorAll(".tpgb-ser-item");l.length==f&&(g[0].classList.add("tp-hide"),a(g[0].parentNode).append("<div class=\"tpgb-post-loaded\">"+m.loadedtxt+"</div>"))},complete:function(){}})})},x=function(c,d,e,f){let g=b[0].querySelectorAll(".post-lazy-load"),h=b[0].querySelector(".tpgb-search-slider"),i=b[0].querySelectorAll(".tpgb-search-pagina");var j,k,l,n,o,p,q=a(window),r=function(){j=q.width(),k=q.height(),l=a("body").height(),o=a(".tpgb-search-area").height(),p=a(".tpgb-search-area").offset().top+50,setTimeout(function(){o=a(".tpgb-search-area").height(),p=a(".tpgb-search-area").offset().top+50},50)};r(),q.resize(r),q.bind("scroll",function(c){c.preventDefault(),r(),n=q.scrollTop(),o=a(".tpgb-search-area").height(),p=a(".tpgb-search-area").offset().top+50;var d=a(".tpgb-search-area").find(".post-lazy-load"),e=b[0].querySelectorAll(".tpgb-ser-item");if(f.offset=e.length,f.loadNumpost=m.loadnumber,a(".tpgb-search-area").find(".post-lazy-load").length&&n<l&&n+60>o+p-k){if(d.data("requestRunning"))return;d.data("requestRunning",!0),jQuery.ajax({url:tpgb_load.ajaxUrl,method:"post",async:!0,data:f,beforeSend:function(){},success:function(c){let d=c.data.posts,e=c.data.total_count,f=null,i="";for(f in d)i+=v(d[f]);a(h).append(i);let j=b[0].querySelectorAll(".tpgb-ser-item");j.length==e&&(g[0].classList.add("tp-hide"),a(g[0].parentNode).append("<div class=\"tpgb-post-loaded\">"+m.loadedtxt+"</div>"))},complete:function(){d.data("requestRunning",!1)}})}})},y=function(c,d,e,f){let g=b[0].querySelector(".tpgb-search-list-inner"),h=b[0].querySelectorAll(".tpgb-pagelink.tpgb-ajax-page"),i=b[0].querySelectorAll(".tpgb-pagelink.next"),j=b[0].querySelectorAll(".tpgb-pagelink.prev"),k=m.Pcounter?m.Pcounter:0,l=m.PClimit?m.PClimit:3;0<h.length&&h.forEach(function(c,d){if(1==+c.dataset.page){let a=b[0].querySelectorAll(".tpgb-search-slider");0<a.length&&a[0].classList.add("ajax-1")}else a(g).append("<div class=\"tpgb-search-slider tpgb-row ajax-"+ +(d+1)+"\"></div>");c.addEventListener("click",function(){let b=this.dataset.page,c=100*d;f.offset=b*r-r,A(h,b),q&&(j[0].setAttribute("data-prev",b),i[0].setAttribute("data-next",b));let k=g.querySelectorAll(".tpgb-search-slider.ajax-"+b);return 0<k.length&&k[0].querySelector(".tpgb-ser-item")?(g.style.cssText="transform: translateX("+-c+"%)",void z(e)):void jQuery.ajax({url:tpgb_load.ajaxUrl,method:"post",async:!0,data:f,beforeSend:function(){},success:function(b){let d=b.data.posts,f=null,h="";for(f in d)h+=v(d[f]);a(k[0]).append(h),g.style.cssText="transform: translateX("+-c+"%)",z(e)},complete:function(){}})})}),0<i.length&&i[0].addEventListener("click",function(){let b=+this.dataset.next,c=b+1,d=-(100*b);f.offset=c*r-r,k&&h.forEach(function(a,b){if(c==+a.dataset.page&&a.classList.contains("tp-hide")){a.classList.remove("tp-hide"),h.forEach(function(a,c){+(b+1-l)==c+1&&a.classList.add("tp-hide")})}}),A(h,c),q&&(j[0].setAttribute("data-prev",c),i[0].setAttribute("data-next",c));let m=g.querySelectorAll(".tpgb-search-slider.ajax-"+c);return 0<m.length&&m[0].querySelector(".tpgb-ser-item")?(g.style.cssText="transform: translateX("+d+"%)",void z(e)):void jQuery.ajax({url:tpgb_load.ajaxUrl,method:"post",async:!0,data:f,beforeSend:function(){},success:function(b){let c=b.data.posts,f=null,h="";for(f in c)h+=v(c[f]);a(m[0]).append(h),g.style.cssText="transform: translateX("+d+"%)",z(e)},complete:function(){}})}),0<j.length&&j[0].addEventListener("click",function(){let b=+this.dataset.prev,c=b-1,d=-(100*c)+100;f.offset=c*r-r,k&&h.forEach(function(a,b){if(c==+a.dataset.page&&a.classList.contains("tp-hide")){a.classList.remove("tp-hide"),h.forEach(function(a,c){+(b+1)+ +l==c+1&&a.classList.add("tp-hide")})}}),A(h,c),q&&(j[0].setAttribute("data-prev",c),i[0].setAttribute("data-next",c));let m=g.querySelectorAll(".tpgb-search-slider.ajax-"+c);return 0<m.length&&m[0].querySelector(".tpgb-ser-item")?(g.style.cssText="transform: translateX("+d+"%)",void z(e)):void jQuery.ajax({url:tpgb_load.ajaxUrl,method:"post",async:!0,data:f,beforeSend:function(){},success:function(b){let c=b.data.posts,f=null,h="";for(f in c)h+=v(c[f]);a(m[0]).append(h),g.style.cssText="transform: translateX("+d+"%)",z(e)},complete:function(){}})})},z=function(c){if(c.columns){let d=b[0].querySelectorAll(".tpgb-pagelink.next"),e=b[0].querySelectorAll(".tpgb-pagelink.prev");if(0<d.length){let b=d[0].dataset&&d[0].dataset.next?d[0].dataset.next:"";parseInt(b)==c.columns?a(".tpgb-pagelink.next").hide():a(".tpgb-pagelink.next").show()}if(0<e.length){let b=e[0].dataset&&e[0].dataset.prev?e[0].dataset.prev:"";1==parseInt(b)?a(".tpgb-pagelink.prev").hide():a(".tpgb-pagelink.prev").show()}}},A=function(a,b){0<a.length&&a.forEach(function(a){b==+a.dataset.page?a.classList.add("active"):a.classList.contains("active")&&a.classList.remove("active")})},B=function(){let c=b[0].querySelector(".tpgb-search-area"),d=b[0].querySelector("input[name=s]"),e=b[0].querySelectorAll(".tpgb-rental-overlay"),f=b[0].querySelector(".tpgb-close-btn");a(f).on("click",function(){d.value="",a(this).hide(),a(c).slideUp(),0<e.length&&(e[0].style.cssText="visibility:hidden;opacity:0;")}),b.keyup(function(b){"Escape"===b.key&&(d.value="",a(c).slideUp(),f.style.cssText="display:none")})}})})(jQuery);